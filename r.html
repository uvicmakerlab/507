<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Notes: English 507 at the University of Victoria</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header"><a href="http://uvicmakerlab.github.io/507/">Engl507</a></h1>
        <p class="header"><a href="http://www.uvic.ca/">University of Victoria</a><br><a href="http://www.jenterysayers.com/">Jentery Sayers</a><br>Spring 2014</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/uvicmakerlab/507/zipball/gh-pages">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/uvicmakerlab/507/tarball/gh-pages">Download TAR</a></li>
          <li class="download"><a class="buttons" href="https://github.com/uvicmakerlab/507/blob/gh-pages/syllabus.pdf?raw=true">Download PDF</a></li>
          <li><a class="buttons github" href="https://github.com/uvicmakerlab/507">GitHub</a></li>
        </ul>

        <p class="header"><a href="description.html">Description</a><br><a href="format.html">Format</a><br><a href="stipulations.html">Stipulations</a><br><a href="objectives.html">Objectives</a><br><a href="assessment.html">Assessment</a><br><a href="policies.html">Policies</a><br><a href="http://www.hastac.org/future-higher-ed" target="_blank">#FutureEd</a></p>


      </header>
      <section>
        <h3>
<a name="description" class="anchor" href="#description"><span class="octicon octicon-link"></span></a>R and Algorithmic Criticism</h3>

<p>R is a free software programming language and software environment for statistical computing and graphics. The R language is widely used among statisticians and data miners for developing statistical software and data analysis.</p>

<p>First, please <a href="http://cran.stat.sfu.ca/" target="_blank">download it</a> via the Comprehensive R Archive Network (CRAN) mirror at SFU (the mirror geographically closest to us) and also download the <a href="http://www.rstudio.com/ide/download/desktop" target="_blank">RStudio Integrated Development Environment (IDE)</a>.</p> 

<p>Next, inspired by and borrowing heavily from Chris Forster's <a href="http://cforster.com/2013/02/reading-the-waves-with-stephen-ramsay/" target="_blank">"With Thanks to Woolf and emacs, Reading <em>The Waves</em> with Stephen Ramsay,"</a> let's walk through (or rehearse, if you will) Ramsay's line of analysis in <a href="http://www.digitalhumanities.org/companion/view?docId=blackwell/9781405148641/9781405148641.xml&chunk.id=ss1-6-7" target="_blank">"Algorithmic Criticism."</a> As we do, we might want to keep in mind <a href="notes7.html">claims</a> (by Samuels, McGann, Kraus, and others) that experimental or conjectural analyses may be more "determinate" than other modes, including social and historical approaches. What do those claims imply? Why? And to what effects on critical practice?</p>

<p>Let's begin by grabbing a copy of <em>The Waves</em> by Virginia Woolf. Like Ramsay and Forster, we can use the <a href="http://gutenberg.net.au/ebooks02/0201091h.html" target="_blank">Gutenberg Australia witness</a> of the text. By copying the HTML version of that text (which does not have carriage returns), we can produce a TXT file for <em>The Waves</em>, making sure to not include peripheral content, including, "This eBook is made available at no cost and with almost no restrictions whatsoever." Here, all we need to do is copy the text from "The sun had not yet risen" to "The waves broke on the shore" and then paste it into a text editor like TextWrangler or Notepad. Then we can save that text file as <code>the-waves.txt</code> on the desktops of our local machines. (Again, make sure you copy the HTML file, not any TXT files of <em>The Waves</em> that you may find on the web. TXT files from Gutenberg often have carriage returns manually inserted into the text. These returns will complicate your results because they will keep you from examining the novel at the paragraph level (by rendering every line of text in the novel an enumerated line of text in an editor). In your editor, an enumerated line should correspond with a paragraph by Woolf.).</p>

<p>When examining this particular novel algorithmically, like Ramsay we'll want to determine things such as the "First twenty-four terms for all  in <em>The Waves</em>." To do that, we're going to ultimately use tf-idf (term frequency–inverse document frequency) for information retrieval. In the case of Woolf's novel, Ramsay suggests: "Let N equal the total number of documents and let df equal the number of documents in which the target term appears. We have six speakers. If the term occurs only in one speaker, we multiply tf by six over one; if it occurs in all speakers, we multiply it by six over six."</p>

<p>Our six speakers are Bernard, Louis, Neville, Jinny, Rhoda, and Susan. And, as Forster observes, <em>The Waves</em> has two primary components: the "interior monologues" (or "semi-monologues") of the characters and the "inter-chapters," which describe the movement of the sun (e.g., "The sun rose higher. Blue waves, green waves swept a quick fan over the beach, circling the spike of sea-holly and leaving shallow pools of light here and there on the sand"). What's more, the monologues are not incredibly difficult to identify. Forster writes: "There is always a short phrase (starting with an opening single quotation mark—i.e. an apostrophe—and a capital letter), some text, a closing single quote (variously punctuated), the word 'said' followed by a character name and some punctuation mark, an opening single quotation mark and some words." All that said, when compared with other novels by Woolf, as well as other modernist novels (generally speaking), this structure renders the novel atypically conducive to algorithmic analysis.</p>

<p>So let's stop and make our first basic observation: <strong>Some texts are more conducive to algorithmic analysis than others.</strong> By extension, some novels will require less manual intervention (e.g., cleaning or marking up the text for computational analysis) than others.</p>

<p>Now, once we have a TXT file titled <code>the-waves.txt</code> on the desktops of our local machines, we can (as Forster suggests) "grep" the novel for lines matching patterns. Grep has a long history dating back to (at least) Unix line editors in the early 1970s and stands for "Globally search a Regular Expression and Print." Here, we will be using it to search for lines in <em>The Waves</em>, not a regular expression (or <a href="http://en.wikipedia.org/wiki/Regular_expression" target="_blank">regex</a>). So let's give grepping a try.</p>

<p>First, create a folder (empty for now) named "woolf" on your desktop. Then, in the command line, use "print working directory," or <pre><code>pwd</code></pre> to determine where you are and then, if you're not on your desktop, use "change directory to desktop," or<br><br><pre><code>cd ~/desktop</code></pre> Once you're on your desktop, as per Forster's suggestion, enter the following six grep commands:<br><br>
<pre><code>grep 'said Bernard' the-waves.txt > woolf/bernard.txt
grep 'said Jinny' the-waves.txt > woolf/jinny.txt
grep 'said Louis' the-waves.txt > woolf/louis.txt
grep 'said Neville' the-waves.txt > woolf/neville.txt
grep 'said Rhoda' the-waves.txt > woolf/rhoda.txt
grep 'said Susan' the-waves.txt > woolf/susan.txt</code></pre>
With each of these commands, we are asking the computer to isolate a particular pattern in "the-waves.txt" (which is on our desktops) and spit the results (line by line) into a new file, corresponding with the character name of the speaker in <em>The Waves</em>. In this case, a line is a paragraph in the novel. And again, the structure of this particular novel is conducive to this approach.</p>

<p>But wait. If we return to <a href="http://gutenberg.net.au/ebooks02/0201091h.html" target="_blank">the novel</a> (egad!), we'll notice that, like all six products of our grep, "bernard.txt" is missing some semi-monologues that appear in Woolf's original. Understood as data corresponding with paragraphs in <em>The Waves</em>, these missing monologues comprise five lines of text in an editor: 
<pre><code>'Now she walks across the field with a swing, nonchalantly, to deceive us. Then she comes to the dip; she thinks she is unseen; she begins to run with her fists clenched in front of her. Her nails meet in the ball of her pocket-handkerchief. She is making for the beech woods out of the light. She spreads her arms as she comes to them and takes to the shade like a swimmer. But she is blind after the light and trips and flings herself down on the roots under the trees, where the light seems to pant in and out, in and out. The branches heave up and down. There is agitation and trouble here. There is gloom. The light is fitful. There is anguish here. The roots make a skeleton on the ground, with dead leaves heaped in the angles. Susan has spread her anguish out. Her pocket-handkerchief is laid on the roots of the beech trees and she sobs, sitting crumpled where she has fallen.'
'No, that is too small, too particular a name. We cannot attach the width and spread of our feelings to so small a mark. We have come together (from the North, from the South, from Susan's farm, from Louis' house of business) to make one thing, not enduring--for what endures?--but seen by many eyes simultaneously. There is a red carnation in that vase. A single flower as we sat here waiting, but now a seven-sided flower, many-petalled, red, puce, purple-shaded, stiff with silver-tinted leaves--a whole flower to which every eye brings its own contribution.
'That goes on. Listen. There is a sound like the knocking of railway trucks in a siding. That is the happy concatenation of one event following another in our lives. Knock, knock, knock. Must, must, must. Must go, must sleep, must wake, must get up--sober, merciful word which we pretend to revile, which we press tight to our hearts, without which we should be undone. How we worship that sound like the knocking together of trucks in a siding!
'Now far off down the river I hear the chorus; the song of the boasting boys, who are coming back in large charabancs from a day's outing on the decks of crowded steamers. Still they are singing as they used to sing, across the court, on winters' nights, or with the windows open in summer, getting drunk, breaking the furniture, wearing little striped caps, all turning their heads the same way as the brake rounded the corner; and I wished to be with them.
'What with the chorus, and the spinning water and the just perceptible murmur of the breeze we are slipping away. Little bits of ourselves are crumbling. There! Something very important fell then. I cannot keep myself together. I shall sleep. But we must go; must catch our train; must walk back to the station--must, must, must. We are only bodies jogging along side by side. I exist only in the soles of my feet and in the tired muscles of my thighs. We have been walking for hours it seems. But where? I cannot remember. I am like a log slipping smoothly over some waterfall. I am not a judge. I am not called upon to give my opinion. Houses and trees are all the same in this grey light. Is that a post? Is that a woman walking? Here is the station, and if the train were to cut me in two, I should come together on the further side, being one, being indivisible. But what is odd is that I still clasp the return half of my ticket to Waterloo firmly between the fingers of my right hand, even now, even sleeping.'</pre></code></p>
<p>That's already quite a few, resulting from the lack of "Bernard said" in five of Woolf's paragraphs.</p>
<p>So let's stop and make our second basic observation: <strong>When working with algorithms and computer vision, don't forget to add a healthy dose of skepticism to your procedural analysis.</strong> Frequently return to the original text to make sure you're not missing key bits of content. Or, if you're working with a substantial amount of text, then at least note (in your ultimate analysis) what you're overlooking or conceding in order to conduct an algorithmic critique, distant/surface reading, or the like.</p>
<p>Given the issues above, for the balance of this workshop, we'll use Forster's pruned iteration of the <em>The Waves</em>, which he so kindly shared with us. (Thanks, Chris!) This will save us at least 90 minutes of editing and should remind us to share our research "data" whenever possible.</p>
<p>For the tf-idf analysis of <em>The Waves</em>, we're going to turn to R, which (in my experience) is most transparent when rendered through RStudio. That said, please run RStudio on your machine.</p>
<p>In RStudio, we'll work in the console. There, start with "get working directory," or <pre><code>getwd()</pre></code> This is identical to <code>pwd</code> in your terminal. But odds are that you wil not be on your desktop. Instead, you'll be in your home directory (something like "admin" or whatever user name you've given your computer.) So let's change your location using "set working directory to my desktop," or (for example)<br><br> <pre><code>setwd("Desktop")</code></pre> Now type<br><br><pre><code>getwd()</pre></code> again just to make sure you're on your desktop.</p>
<p>Next we're going to follow Forster's instructions line by line and make an R "corpus" based on the six pruned TXT files (one for each speaker in <em>The Waves</em>) he provided us. We'll start by installing the "tm" (or <a href="http://cran.r-project.org/web/packages/tm/index.html" target="_blank">"text mining"</a>) package in RStudio. In the bottom-right window, click the "Packages" tab, then "Install Packages," and then type "tm" into the search field. Click on the "tm" result and then press "Install" (leave the "Install Dependencies" box checked, too). The package should install rather quickly, and I encourage you to install other packages (including visualization packages) for work you'll do on your own.</p>
<p>After you've installed the "tm" package, repeat the step above and install <a href="http://cran.r-project.org/web/packages/SnowballC/index.html" target="_blank">"SnowballC,"</a> which is a stemming algorithm. Ultimately, then, you're installing two packages beyond R and RStudio's default set.</p>
<p>Now, in your R console, type what Forster recommends (or you can just highlight the content of each text box and paste it into R; each box below represents a single command): <br><br>
Call the tm (text mining) package in R.<pre><code>library('tm')</pre></code>Create a "corpus" called "woolf" based on the "woolf" repo of six files currently on your desktop.
<pre><code>woolf <- Corpus(DirSource('woolf/'))</pre></code>

For consistency's sake, make all text characters in the "woolf" corpus lower case.
<pre><code>woolf <- tm_map(woolf,tolower)</pre></code>

For consistency's sake, remove all punctuation from the "woolf" corpus.
<pre><code>woolf <- tm_map(woolf,removePunctuation)</pre></code>

Remove stopwords for the English language.
<pre><code>woolf <- tm_map(woolf,removeWords, stopwords('english'))</code></pre></p>

<p>But hey! Now matter how common, words like totally matter. So let's stop and make our third basic observation: <strong>When conducting text analysis and other procedural analyses, review the stopword list and keep it available for reference.</strong> Additionally, when writing essays that employ text analysis and the use of stopwords, consider including, attaching, or referencing your stopword list. You should also mention whether you <a href="http://en.wikipedia.org/wiki/Stemming" target="_blank">stemmed</a>, depunctuated, decased, or otherwise modified the text.</p>
<p>Fortunately, in R we can see the "tm" package's stopword list for English by entering this command:<pre><code>stopwords(kind="en")</pre></code> Whew.</p>
<p>Now that we've "treated" <em>The Waves</em> for procedural analysis, we'll learn from Forster and create a "Document-Term Matrix" (DTM) for our corpus called "woolf". In this instance, a DTM based on <em>The Waves</em> is a rectangular array of words arranged in rows and columns, which together describe the frequency of terms occurring in our six TXT files. In our DTM, rows will correspond with TXT files (or documents) in the collection, and columns will correspond with words.</p>
<p>Here's a good time to make our fourth basic observation: <strong>The use of software programming languages and environments like R to generate, treat, examine, and express document-term matrices and other arrays is not simply an analysis of texts. It is the performative transformation (or deformation) of texts.</strong> In a sense, it is comparable to reading backwards, often with the hope of generating unpredictable or surprising results, which are premised on brushing against the very "senses of the text" (Samuels and McGann 36). To put it bluntly: we are changing the text, not just interpreting it.</p>
<p>So let's create that DTM in the R console, using tf-idf like Ramsay and Forster do:<pre><code>dtm <- DocumentTermMatrix(woolf, control=list(weighting=weightTfIdf))</code></pre></p> 
<p>R should have generated the DTM, but let's make sure. Follow Forster's steps and inspect the DTM. In R, we can call all texts in the matrix or just specific texts. We can also call specific columns, which (again) correspond with words in <em>The Waves</em>. Let's try both. First, call all texts and express columns 35 through 45: <pre><code>inspect(dtm[,35:45])</code></pre> You should then see some results, with the tf-idf score for each word, in each text. Yep? Now, try calling a specific text in the matrix, using the same columns as before:<br> <br>
<pre><code>inspect(dtm[1,35:45])</code></pre> Here you should get the results for Bernard. If not, then let me know.</p>
<p>Now's a good time to stop and make our fifth basic observation: <strong>When studying the results of text analysis, note the differences between frequencies and counts.</strong> This observation is perhaps obvious, but making it doesn't hurt. And it's central to understanding procedural analyses and algorithmic criticism.</p> 
<p> Our next step is to see if, like Forster, we can generate the same results as Ramsay. To do so, we're going to extract data from the DTM into six lists and then arrange those lists by their tf-idf scores. More specifically, we're going to draw what Ramsay calls the "First twenty-four terms for all characters in <em>The Waves</em>." Let's give it a whirl.</p>
<p>Following Forster, let's call the matrix output "m":<pre><code>m <- as.matrix(dtm)</code></pre> Now let's generate a list of words (based on tf-idf scores) for all six speakers, or–to be exact–for all six documents in our corpus:<br><br> <pre><code>bernard <- sort(m[1,], decreasing=TRUE)
jinny <- sort(m[2,], decreasing=TRUE)
louis <- sort(m[3,], decreasing=TRUE)
neville <- sort(m[4,], decreasing=TRUE)
rhoda <- sort(m[5,], decreasing=TRUE)
susan <- sort(m[6,], decreasing=TRUE)</code></pre></p>

Finally, we'll call the first 24 results for each of the above. That data will be expressed, speaker by speaker, in the R console:<br><br>
<pre><code>bernard[1:24]
jinny[1:24]
louis[1:24]
neville[1:24]
rhoda[1:24]
susan[1:24]</code></pre>
<p>Did we get the same results as Ramsay? As Forster? Why or why not? And in what relation to claims for the determinacy of methods in our readings about deformance, conjecture, and algorithmic criticism?</p>
<p>To unpack your results, check out <a href="http://cforster.com/2013/02/reading-the-waves-with-stephen-ramsay/" target="_blank">Forster's approach</a> in the second half of his piece. Also consider Collier's work on <a href="http://www.exegetic.biz/blog/2013/09/text-mining-the-complete-works-of-william-shakespeare/" target="_blank">"Text Mining the Complete Works of William Shakespeare"</a>, where he will introduce you to not only term-document matrices (or TDMs) but also visualization libraries in R. Using Collier's work, you can produce visualizations like the one, of <em>The Waves</em>, below.</p>
<img src="wavesRPlot.png" alt="R Plot Visualization of The Waves"> 
<p>Let's conclude, then, with our sixth basic observation: <strong>Replicating the procedures of algorithmic criticism is like detective work. You need to attend to the material particulars without assuming you can ever perform a practice exactly like someone else. Recalling Wendy Chun: in the push for determinacy of method, the details of the compiling (or re-membering) process are fundamental.</strong> A follow-up question, then: of what (if any) use is R or algorithmic criticism to your research?</p> 



 </section>
      <footer>
        
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		          <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("&lt;script&gt;   (function(i,s,o,g,r,a,m){i[&#39;GoogleAnalyticsObject&#39;]=r;i[r]=i[r]||function(){   (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),   m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)   })(window,document,&#39;script&#39;,&#39;//www.google-analytics.com/analytics.js&#39;,&#39;ga&#39;);    ga(&#39;create&#39;, &#39;UA-46858077-1&#39;, &#39;uvicmakerlab.github.io&#39;);   ga(&#39;send&#39;, &#39;pageview&#39;);  &lt;/script&gt;");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
